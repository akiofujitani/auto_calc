import file_handler, json_config, log_builder, logging, keyboard, threading, vca_handler, frame_resize, calc_proccess
from classes import *
from time import sleep
from ntpath import join

logger = logging.getLogger('auto_calc')


'''
=============================================================================================

        Template        Template        Template        Template        Template        

=============================================================================================
''' 

config = '''
{
    "sleep_time" : 3,
    "input" : "./",
    "output" : "./",
    "error" : "./",
    "extension" : "vca"
}
'''

parameters_template = '''
{
    "frame_type" : {
        "plastic" : "1",
        "rimless" : "1",
        "metal" : "2",
        "rimless_grooved" : "3",
        "safety" : "4"
    },
    "default_ipd" : "32",
    "default_ocht" : "21",
    "default_dbl" : "18",
    "corrlen_ocht" : {
        "14" : {
            "min" : "14",
            "max" : "18"
        },
        "16" : {
            "min" : "19",
            "max" : "23"  
        },
        "18" : {
            "min" : "24",
            "max" : "29"  
        },
        "20" : {
            "min" : "30",
            "max" : "40"  
        }
    },
    "thick_on_vertical_ax" : "1.50",
    "min_sph_value" : "0.50"
}
'''

min_thickness_template = '''
{
    "plastic" : {
        "5.00" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}           
        },
        "4.75" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}            
        },
        "4.50" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}            
        },
        "4.25" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}            
        },
        "4.00" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}            
        },
        "3.75" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "3.50" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "3.25" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "3.00" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "2.75" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "2.50" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "2.25" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "2.00" : {
            "low" : {"CT" : "", "ET" : "1.80"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "1.75" : {
            "low" : {"CT" : "", "ET" : "1.80"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.50"}            
        },
        "1.50" : {
            "low" : {"CT" : "", "ET" : "1.80"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.50"}            
        },
        "1.25" : {
            "low" : {"CT" : "", "ET" : "1.90"},
            "mid" : {"CT" : "", "ET" : "1.80"},
            "high" : {"CT" : "", "ET" : "1.80"},
            "poly" : {"CT" : "", "ET" : "1.70"}            
        },
        "1.00" : {
            "low" : {"CT" : "", "ET" : "2.00"},
            "mid" : {"CT" : "", "ET" : "1.90"},
            "high" : {"CT" : "", "ET" : "1.90"},
            "poly" : {"CT" : "", "ET" : "1.80"}            
        },
        "0.75" : {
            "low" : {"CT" : "", "ET" : "2.10"},
            "mid" : {"CT" : "", "ET" : "2.00"},
            "high" : {"CT" : "", "ET" : "2.00"},
            "poly" : {"CT" : "", "ET" : "1.80"}            
        },
        "0.50" : {
            "low" : {"CT" : "", "ET" : "2.10"},
            "mid" : {"CT" : "", "ET" : "2.00"},
            "high" : {"CT" : "", "ET" : "2.00"},
            "poly" : {"CT" : "", "ET" : "1.80"}            
        },
        "0.25" : {
            "low" : {"CT" : "2.90", "ET" : ""},
            "mid" : {"CT" : "2.90", "ET" : ""},
            "high" : {"CT" : "2.90", "ET" : ""},
            "poly" : {"CT" : "2.90", "ET" : ""}            
        },
        "0.00" : {
            "low" : {"CT" : "3.00", "ET" : ""},
            "mid" : {"CT" : "2.90", "ET" : ""},
            "high" : {"CT" : "2.90", "ET" : ""},
            "poly" : {"CT" : "2.90", "ET" : ""}            
        },
        "-0.25" : {
            "low" : {"CT" : "2.80", "ET" : ""},
            "mid" : {"CT" : "2.70", "ET" : ""},
            "high" : {"CT" : "2.70", "ET" : ""},
            "poly" : {"CT" : "2.70", "ET" : ""}            
        },
        "-0.50" : {
            "low" : {"CT" : "2.60", "ET" : ""},
            "mid" : {"CT" : "2.50", "ET" : ""},
            "high" : {"CT" : "2.50", "ET" : ""},
            "poly" : {"CT" : "2.40", "ET" : ""}            
        },
        "-0.75" : {
            "low" : {"CT" : "2.30", "ET" : ""},
            "mid" : {"CT" : "2.20", "ET" : ""},
            "high" : {"CT" : "2.20", "ET" : ""},
            "poly" : {"CT" : "2.10", "ET" : ""}            
        },
        "-1.00" : {
            "low" : {"CT" : "2.10", "ET" : ""},
            "mid" : {"CT" : "2.00", "ET" : ""},
            "high" : {"CT" : "2.00", "ET" : ""},
            "poly" : {"CT" : "1.90", "ET" : ""}            
        },
        "-1.25" : {
            "low" : {"CT" : "2.00", "ET" : ""},
            "mid" : {"CT" : "1.90", "ET" : ""},
            "high" : {"CT" : "1.90", "ET" : ""},
            "poly" : {"CT" : "1.80", "ET" : ""}            
        },
        "-1.50" : {
            "low" : {"CT" : "2.00", "ET" : ""},
            "mid" : {"CT" : "1.90", "ET" : ""},
            "high" : {"CT" : "1.90", "ET" : ""},
            "poly" : {"CT" : "1.80", "ET" : ""}            
        },
        "-1.75" : {
            "low" : {"CT" : "1.90", "ET" : ""},
            "mid" : {"CT" : "1.80", "ET" : ""},
            "high" : {"CT" : "1.80", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.00" : {
            "low" : {"CT" : "1.90", "ET" : ""},
            "mid" : {"CT" : "1.80", "ET" : ""},
            "high" : {"CT" : "1.80", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.25" : {
            "low" : {"CT" : "1.80", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.50" : {
            "low" : {"CT" : "1.80", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.75" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-3.00" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-3.25" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-3.50" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-3.50" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-3.75" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-4.00" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-4.25" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-4.50" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-4.75" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-5.00" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        }
    },
    "rimless" : {
        "5.00" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}           
        },
        "4.75" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}            
        },
        "4.50" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}            
        },
        "4.25" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}            
        },
        "4.00" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}            
        },
        "3.75" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "3.50" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "3.25" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "3.00" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "2.75" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "2.50" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "2.25" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "2.00" : {
            "low" : {"CT" : "", "ET" : "1.80"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "1.75" : {
            "low" : {"CT" : "", "ET" : "1.80"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.50"}            
        },
        "1.50" : {
            "low" : {"CT" : "", "ET" : "1.80"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.50"}            
        },
        "1.25" : {
            "low" : {"CT" : "", "ET" : "1.90"},
            "mid" : {"CT" : "", "ET" : "1.80"},
            "high" : {"CT" : "", "ET" : "1.80"},
            "poly" : {"CT" : "", "ET" : "1.70"}            
        },
        "1.00" : {
            "low" : {"CT" : "", "ET" : "2.00"},
            "mid" : {"CT" : "", "ET" : "1.90"},
            "high" : {"CT" : "", "ET" : "1.90"},
            "poly" : {"CT" : "", "ET" : "1.80"}            
        },
        "0.75" : {
            "low" : {"CT" : "", "ET" : "2.10"},
            "mid" : {"CT" : "", "ET" : "2.00"},
            "high" : {"CT" : "", "ET" : "2.00"},
            "poly" : {"CT" : "", "ET" : "1.80"}            
        },
        "0.50" : {
            "low" : {"CT" : "", "ET" : "2.10"},
            "mid" : {"CT" : "", "ET" : "2.00"},
            "high" : {"CT" : "", "ET" : "2.00"},
            "poly" : {"CT" : "", "ET" : "1.80"}            
        },
        "0.25" : {
            "low" : {"CT" : "2.90", "ET" : ""},
            "mid" : {"CT" : "2.90", "ET" : ""},
            "high" : {"CT" : "2.90", "ET" : ""},
            "poly" : {"CT" : "2.90", "ET" : ""}            
        },
        "0.00" : {
            "low" : {"CT" : "3.00", "ET" : ""},
            "mid" : {"CT" : "2.90", "ET" : ""},
            "high" : {"CT" : "2.90", "ET" : ""},
            "poly" : {"CT" : "2.90", "ET" : ""}            
        },
        "-0.25" : {
            "low" : {"CT" : "2.80", "ET" : ""},
            "mid" : {"CT" : "2.70", "ET" : ""},
            "high" : {"CT" : "2.70", "ET" : ""},
            "poly" : {"CT" : "2.70", "ET" : ""}            
        },
        "-0.50" : {
            "low" : {"CT" : "2.60", "ET" : ""},
            "mid" : {"CT" : "2.50", "ET" : ""},
            "high" : {"CT" : "2.50", "ET" : ""},
            "poly" : {"CT" : "2.40", "ET" : ""}            
        },
        "-0.75" : {
            "low" : {"CT" : "2.30", "ET" : ""},
            "mid" : {"CT" : "2.20", "ET" : ""},
            "high" : {"CT" : "2.20", "ET" : ""},
            "poly" : {"CT" : "2.10", "ET" : ""}            
        },
        "-1.00" : {
            "low" : {"CT" : "2.10", "ET" : ""},
            "mid" : {"CT" : "2.00", "ET" : ""},
            "high" : {"CT" : "2.00", "ET" : ""},
            "poly" : {"CT" : "1.90", "ET" : ""}            
        },
        "-1.25" : {
            "low" : {"CT" : "2.00", "ET" : ""},
            "mid" : {"CT" : "1.90", "ET" : ""},
            "high" : {"CT" : "1.90", "ET" : ""},
            "poly" : {"CT" : "1.80", "ET" : ""}            
        },
        "-1.50" : {
            "low" : {"CT" : "2.00", "ET" : ""},
            "mid" : {"CT" : "1.90", "ET" : ""},
            "high" : {"CT" : "1.90", "ET" : ""},
            "poly" : {"CT" : "1.80", "ET" : ""}            
        },
        "-1.75" : {
            "low" : {"CT" : "1.90", "ET" : ""},
            "mid" : {"CT" : "1.80", "ET" : ""},
            "high" : {"CT" : "1.80", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.00" : {
            "low" : {"CT" : "1.90", "ET" : ""},
            "mid" : {"CT" : "1.80", "ET" : ""},
            "high" : {"CT" : "1.80", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.25" : {
            "low" : {"CT" : "1.80", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.50" : {
            "low" : {"CT" : "1.80", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.75" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-3.00" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-3.25" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-3.50" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-3.50" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-3.75" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-4.00" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-4.25" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-4.50" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-4.75" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-5.00" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        }
    },
    "metal" : {
        "5.00" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}           
        },
        "4.75" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}            
        },
        "4.50" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}            
        },
        "4.25" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}            
        },
        "4.00" : {
            "low" : {"CT" : "", "ET" : "1.50"},
            "mid" : {"CT" : "", "ET" : "1.50"},
            "high" : {"CT" : "", "ET" : "1.50"},
            "poly" : {"CT" : "", "ET" : "1.30"}            
        },
        "3.75" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "3.50" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "3.25" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "3.00" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "2.75" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "2.50" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "2.25" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "2.00" : {
            "low" : {"CT" : "", "ET" : "1.80"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.40"}            
        },
        "1.75" : {
            "low" : {"CT" : "", "ET" : "1.80"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.50"}            
        },
        "1.50" : {
            "low" : {"CT" : "", "ET" : "1.80"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.50"}            
        },
        "1.25" : {
            "low" : {"CT" : "", "ET" : "1.90"},
            "mid" : {"CT" : "", "ET" : "1.80"},
            "high" : {"CT" : "", "ET" : "1.80"},
            "poly" : {"CT" : "", "ET" : "1.70"}            
        },
        "1.00" : {
            "low" : {"CT" : "", "ET" : "2.00"},
            "mid" : {"CT" : "", "ET" : "1.90"},
            "high" : {"CT" : "", "ET" : "1.90"},
            "poly" : {"CT" : "", "ET" : "1.80"}            
        },
        "0.75" : {
            "low" : {"CT" : "", "ET" : "2.10"},
            "mid" : {"CT" : "", "ET" : "2.00"},
            "high" : {"CT" : "", "ET" : "2.00"},
            "poly" : {"CT" : "", "ET" : "1.80"}            
        },
        "0.50" : {
            "low" : {"CT" : "", "ET" : "2.10"},
            "mid" : {"CT" : "", "ET" : "2.00"},
            "high" : {"CT" : "", "ET" : "2.00"},
            "poly" : {"CT" : "", "ET" : "1.80"}            
        },
        "0.25" : {
            "low" : {"CT" : "2.90", "ET" : ""},
            "mid" : {"CT" : "2.90", "ET" : ""},
            "high" : {"CT" : "2.90", "ET" : ""},
            "poly" : {"CT" : "2.90", "ET" : ""}            
        },
        "0.00" : {
            "low" : {"CT" : "3.00", "ET" : ""},
            "mid" : {"CT" : "2.90", "ET" : ""},
            "high" : {"CT" : "2.90", "ET" : ""},
            "poly" : {"CT" : "2.90", "ET" : ""}            
        },
        "-0.25" : {
            "low" : {"CT" : "2.80", "ET" : ""},
            "mid" : {"CT" : "2.70", "ET" : ""},
            "high" : {"CT" : "2.70", "ET" : ""},
            "poly" : {"CT" : "2.70", "ET" : ""}            
        },
        "-0.50" : {
            "low" : {"CT" : "2.60", "ET" : ""},
            "mid" : {"CT" : "2.50", "ET" : ""},
            "high" : {"CT" : "2.50", "ET" : ""},
            "poly" : {"CT" : "2.40", "ET" : ""}            
        },
        "-0.75" : {
            "low" : {"CT" : "2.30", "ET" : ""},
            "mid" : {"CT" : "2.20", "ET" : ""},
            "high" : {"CT" : "2.20", "ET" : ""},
            "poly" : {"CT" : "2.10", "ET" : ""}            
        },
        "-1.00" : {
            "low" : {"CT" : "2.10", "ET" : ""},
            "mid" : {"CT" : "2.00", "ET" : ""},
            "high" : {"CT" : "2.00", "ET" : ""},
            "poly" : {"CT" : "1.90", "ET" : ""}            
        },
        "-1.25" : {
            "low" : {"CT" : "2.00", "ET" : ""},
            "mid" : {"CT" : "1.90", "ET" : ""},
            "high" : {"CT" : "1.90", "ET" : ""},
            "poly" : {"CT" : "1.80", "ET" : ""}            
        },
        "-1.50" : {
            "low" : {"CT" : "2.00", "ET" : ""},
            "mid" : {"CT" : "1.90", "ET" : ""},
            "high" : {"CT" : "1.90", "ET" : ""},
            "poly" : {"CT" : "1.80", "ET" : ""}            
        },
        "-1.75" : {
            "low" : {"CT" : "1.90", "ET" : ""},
            "mid" : {"CT" : "1.80", "ET" : ""},
            "high" : {"CT" : "1.80", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.00" : {
            "low" : {"CT" : "1.90", "ET" : ""},
            "mid" : {"CT" : "1.80", "ET" : ""},
            "high" : {"CT" : "1.80", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.25" : {
            "low" : {"CT" : "1.80", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.50" : {
            "low" : {"CT" : "1.80", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.75" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-3.00" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-3.25" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-3.50" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-3.50" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-3.75" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-4.00" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-4.25" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-4.50" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-4.75" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        },
        "-5.00" : {
            "low": {"CT" : "1.70", "ET" : ""},
            "mid": {"CT" : "1.70", "ET" : ""},
            "high": {"CT" : "1.70", "ET" : ""},
            "poly": {"CT" : "1.70", "ET" : ""}            
        }
    },
    "rimless_grooved" : {
        "5.00" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.60"}           
        },
        "4.75" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.60"}           
        },
        "4.50" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.60"}           
        },
        "4.25" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.60"}           
        },
        "4.00" : {
            "low" : {"CT" : "", "ET" : "1.60"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.60"}           
        },
        "3.75" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.60"}           
        },
        "3.50" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.60"}           
        },
        "3.25" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.60"},
            "high" : {"CT" : "", "ET" : "1.60"},
            "poly" : {"CT" : "", "ET" : "1.60"}           
        },
        "3.00" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.70"}           
        },
        "2.75" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.70"}           
        },
        "2.50" : {
            "low" : {"CT" : "", "ET" : "1.70"},
            "mid" : {"CT" : "", "ET" : "1.70"},
            "high" : {"CT" : "", "ET" : "1.70"},
            "poly" : {"CT" : "", "ET" : "1.70"}           
        },
        "2.25" : {
            "low" : {"CT" : "", "ET" : "1.80"},
            "mid" : {"CT" : "", "ET" : "1.80"},
            "high" : {"CT" : "", "ET" : "1.80"},
            "poly" : {"CT" : "", "ET" : "1.80"}           
        },
        "2.00" : {
            "low" : {"CT" : "", "ET" : "1.80"},
            "mid" : {"CT" : "", "ET" : "1.80"},
            "high" : {"CT" : "", "ET" : "1.80"},
            "poly" : {"CT" : "", "ET" : "1.80"}           
        },
        "1.75" : {
            "low" : {"CT" : "", "ET" : "1.90"},
            "mid" : {"CT" : "", "ET" : "1.80"},
            "high" : {"CT" : "", "ET" : "1.80"},
            "poly" : {"CT" : "", "ET" : "1.80"}           
        },
        "1.50" : {
            "low" : {"CT" : "", "ET" : "1.90"},
            "mid" : {"CT" : "", "ET" : "1.90"},
            "high" : {"CT" : "", "ET" : "1.90"},
            "poly" : {"CT" : "", "ET" : "1.90"}           
        },
        "1.25" : {
            "low" : {"CT" : "", "ET" : "1.90"},
            "mid" : {"CT" : "", "ET" : "1.90"},
            "high" : {"CT" : "", "ET" : "1.90"},
            "poly" : {"CT" : "", "ET" : "1.90"}           
        },
        "1.00" : {
            "low" : {"CT" : "", "ET" : "1.90"},
            "mid" : {"CT" : "", "ET" : "1.90"},
            "high" : {"CT" : "", "ET" : "1.90"},
            "poly" : {"CT" : "", "ET" : "1.90"}           
        },
        "0.75" : {
            "low" : {"CT" : "", "ET" : "1.90"},
            "mid" : {"CT" : "", "ET" : "1.90"},
            "high" : {"CT" : "", "ET" : "1.90"},
            "poly" : {"CT" : "", "ET" : "1.90"}           
        },
        "0.50" : {
            "low" : {"CT" : "", "ET" : "2.00"},
            "mid" : {"CT" : "", "ET" : "2.00"},
            "high" : {"CT" : "", "ET" : "2.00"},
            "poly" : {"CT" : "", "ET" : "2.00"}           
        },
        "0.25" : {
            "low" : {"CT" : "", "ET" : "2.00"},
            "mid" : {"CT" : "", "ET" : "2.00"},
            "high" : {"CT" : "", "ET" : "2.00"},
            "poly" : {"CT" : "", "ET" : "2.00"}           
        },
        "0.00" : {
            "low" : {"CT" : "3.10", "ET" : ""},
            "mid" : {"CT" : "3.00", "ET" : ""},
            "high" : {"CT" : "3.00", "ET" : ""},
            "poly" : {"CT" : "3.00", "ET" : ""}            
        },
        "-0.25" : {
            "low" : {"CT" : "3.00", "ET" : ""},
            "mid" : {"CT" : "2.90", "ET" : ""},
            "high" : {"CT" : "2.90", "ET" : ""},
            "poly" : {"CT" : "2.90", "ET" : ""}            
        },
        "-0.50" : {
            "low" : {"CT" : "2.80", "ET" : ""},
            "mid" : {"CT" : "2.80", "ET" : ""},
            "high" : {"CT" : "2.80", "ET" : ""},
            "poly" : {"CT" : "2.70", "ET" : ""}            
        },
        "-0.75" : {
            "low" : {"CT" : "2.60", "ET" : ""},
            "mid" : {"CT" : "2.60", "ET" : ""},
            "high" : {"CT" : "2.50", "ET" : ""},
            "poly" : {"CT" : "2.50", "ET" : ""}            
        },
        "-1.00" : {
            "low" : {"CT" : "2.30", "ET" : ""},
            "mid" : {"CT" : "2.30", "ET" : ""},
            "high" : {"CT" : "2.20", "ET" : ""},
            "poly" : {"CT" : "2.10", "ET" : ""}            
        },
        "-1.25" : {
            "low" : {"CT" : "2.20", "ET" : ""},
            "mid" : {"CT" : "2.20", "ET" : ""},
            "high" : {"CT" : "2.10", "ET" : ""},
            "poly" : {"CT" : "2.00", "ET" : ""}            
        },
        "-1.50" : {
            "low" : {"CT" : "2.00", "ET" : ""},
            "mid" : {"CT" : "2.00", "ET" : ""},
            "high" : {"CT" : "1.90", "ET" : ""},
            "poly" : {"CT" : "1.80", "ET" : ""}            
        },
        "-1.75" : {
            "low" : {"CT" : "1.90", "ET" : ""},
            "mid" : {"CT" : "1.90", "ET" : ""},
            "high" : {"CT" : "1.80", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.00" : {
            "low" : {"CT" : "1.80", "ET" : ""},
            "mid" : {"CT" : "1.80", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.25" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.50" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-2.75" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-3.00" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-3.25" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-3.50" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-3.50" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-3.75" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-4.00" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-4.25" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-4.50" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-4.75" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        },
        "-5.00" : {
            "low" : {"CT" : "1.70", "ET" : ""},
            "mid" : {"CT" : "1.70", "ET" : ""},
            "high" : {"CT" : "1.70", "ET" : ""},
            "poly" : {"CT" : "1.70", "ET" : ""}            
        }
    },
    "safety" : {
        "5.00" : {
            "low" : {"CT" : "", "ET" : "2.00"},
            "mid" : {"CT" : "", "ET" : "2.00"},
            "high" : {"CT" : "", "ET" : "2.00"},
            "poly" : {"CT" : "", "ET" : "2.00"}           
        },
        "4.75" : {
            "low" : {"CT" : "", "ET" : "2.00"},
            "mid" : {"CT" : "", "ET" : "2.00"},
            "high" : {"CT" : "", "ET" : "2.00"},
            "poly" : {"CT" : "", "ET" : "2.00"}            
        },
        "4.50" : {
            "low" : {"CT" : "", "ET" : "2.00"},
            "mid" : {"CT" : "", "ET" : "2.00"},
            "high" : {"CT" : "", "ET" : "2.00"},
            "poly" : {"CT" : "", "ET" : "2.00"}            
        },
        "4.25" : {
            "low" : {"CT" : "", "ET" : "2.00"},
            "mid" : {"CT" : "", "ET" : "2.00"},
            "high" : {"CT" : "", "ET" : "2.00"},
            "poly" : {"CT" : "", "ET" : "2.00"}            
        },
        "4.00" : {
            "low" : {"CT" : "", "ET" : "2.10"},
            "mid" : {"CT" : "", "ET" : "2.10"},
            "high" : {"CT" : "", "ET" : "2.10"},
            "poly" : {"CT" : "", "ET" : "2.10"}            
        },
        "3.75" : {
            "low" : {"CT" : "", "ET" : "2.10"},
            "mid" : {"CT" : "", "ET" : "2.10"},
            "high" : {"CT" : "", "ET" : "2.10"},
            "poly" : {"CT" : "", "ET" : "2.10"}            
        },
        "3.50" : {
            "low" : {"CT" : "", "ET" : "2.10"},
            "mid" : {"CT" : "", "ET" : "2.10"},
            "high" : {"CT" : "", "ET" : "2.10"},
            "poly" : {"CT" : "", "ET" : "2.10"}            
        },
        "3.25" : {
            "low" : {"CT" : "", "ET" : "2.20"},
            "mid" : {"CT" : "", "ET" : "2.20"},
            "high" : {"CT" : "", "ET" : "2.20"},
            "poly" : {"CT" : "", "ET" : "2.10"}            
        },
        "3.00" : {
            "low" : {"CT" : "", "ET" : "2.20"},
            "mid" : {"CT" : "", "ET" : "2.20"},
            "high" : {"CT" : "", "ET" : "2.20"},
            "poly" : {"CT" : "", "ET" : "2.10"}            
        },
        "2.75" : {
            "low" : {"CT" : "", "ET" : "2.20"},
            "mid" : {"CT" : "", "ET" : "2.20"},
            "high" : {"CT" : "", "ET" : "2.20"},
            "poly" : {"CT" : "", "ET" : "2.10"}            
        },
        "2.50" : {
            "low" : {"CT" : "", "ET" : "2.30"},
            "mid" : {"CT" : "", "ET" : "2.30"},
            "high" : {"CT" : "", "ET" : "2.30"},
            "poly" : {"CT" : "", "ET" : "2.20"}            
        },
        "2.25" : {
            "low" : {"CT" : "", "ET" : "2.30"},
            "mid" : {"CT" : "", "ET" : "2.30"},
            "high" : {"CT" : "", "ET" : "2.30"},
            "poly" : {"CT" : "", "ET" : "2.20"}            
        },
        "2.00" : {
            "low" : {"CT" : "", "ET" : "2.30"},
            "mid" : {"CT" : "", "ET" : "2.30"},
            "high" : {"CT" : "", "ET" : "2.30"},
            "poly" : {"CT" : "", "ET" : "2.30"}            
        },
        "1.75" : {
            "low" : {"CT" : "", "ET" : "2.30"},
            "mid" : {"CT" : "", "ET" : "2.30"},
            "high" : {"CT" : "", "ET" : "2.30"},
            "poly" : {"CT" : "", "ET" : "2.30"}            
        },
        "1.50" : {
            "low" : {"CT" : "", "ET" : "2.30"},
            "mid" : {"CT" : "", "ET" : "2.30"},
            "high" : {"CT" : "", "ET" : "2.30"},
            "poly" : {"CT" : "", "ET" : "2.30"}            
        },
        "1.25" : {
            "low" : {"CT" : "", "ET" : "2.30"},
            "mid" : {"CT" : "", "ET" : "2.30"},
            "high" : {"CT" : "", "ET" : "2.30"},
            "poly" : {"CT" : "", "ET" : "2.30"}            
        },
        "1.00" : {
            "low" : {"CT" : "", "ET" : "2.30"},
            "mid" : {"CT" : "", "ET" : "2.30"},
            "high" : {"CT" : "", "ET" : "2.30"},
            "poly" : {"CT" : "", "ET" : "2.30"}            
        },
        "0.75" : {
            "low" : {"CT" : "", "ET" : "2.30"},
            "mid" : {"CT" : "", "ET" : "2.30"},
            "high" : {"CT" : "", "ET" : "2.30"},
            "poly" : {"CT" : "", "ET" : "2.30"}            
        },
        "0.50" : {
            "low" : {"CT" : "", "ET" : "2.40"},
            "mid" : {"CT" : "", "ET" : "2.30"},
            "high" : {"CT" : "", "ET" : "2.30"},
            "poly" : {"CT" : "", "ET" : "2.30"}            
        },
        "0.25" : {
            "low" : {"CT" : "", "ET" : "2.50"},
            "mid" : {"CT" : "", "ET" : "2.40"},
            "high" : {"CT" : "", "ET" : "2.40"},
            "poly" : {"CT" : "", "ET" : "2.30"}            
        },
        "0.00" : {
            "low" : {"CT" : "", "ET" : "2.50"},
            "mid" : {"CT" : "", "ET" : "2.40"},
            "high" : {"CT" : "", "ET" : "2.40"},
            "poly" : {"CT" : "", "ET" : "2.30"}            
        },
        "-0.25" : {
            "low" : {"CT" : "3.10", "ET" : ""},
            "mid" : {"CT" : "3.00", "ET" : ""},
            "high" : {"CT" : "3.00", "ET" : ""},
            "poly" : {"CT" : "3.00", "ET" : ""}            
        },
        "-0.50" : {
            "low" : {"CT" : "2.80", "ET" : ""},
            "mid" : {"CT" : "2.70", "ET" : ""},
            "high" : {"CT" : "2.70", "ET" : ""},
            "poly" : {"CT" : "2.60", "ET" : ""}            
        },
        "-0.75" : {
            "low" : {"CT" : "2.60", "ET" : ""},
            "mid" : {"CT" : "2.50", "ET" : ""},
            "high" : {"CT" : "2.50", "ET" : ""},
            "poly" : {"CT" : "2.40", "ET" : ""}            
        },
        "-1.00" : {
            "low" : {"CT" : "2.50", "ET" : ""},
            "mid" : {"CT" : "2.40", "ET" : ""},
            "high" : {"CT" : "2.40", "ET" : ""},
            "poly" : {"CT" : "2.30", "ET" : ""}            
        },
        "-1.25" : {
            "low" : {"CT" : "2.40", "ET" : ""},
            "mid" : {"CT" : "2.30", "ET" : ""},
            "high" : {"CT" : "2.30", "ET" : ""},
            "poly" : {"CT" : "2.30", "ET" : ""}            
        },
        "-1.50" : {
            "low" : {"CT" : "2.40", "ET" : ""},
            "mid" : {"CT" : "2.30", "ET" : ""},
            "high" : {"CT" : "2.30", "ET" : ""},
            "poly" : {"CT" : "2.30", "ET" : ""}            
        },
        "-1.75" : {
            "low" : {"CT" : "2.40", "ET" : ""},
            "mid" : {"CT" : "2.30", "ET" : ""},
            "high" : {"CT" : "2.30", "ET" : ""},
            "poly" : {"CT" : "2.30", "ET" : ""}            
        },
        "-2.00" : {
            "low" : {"CT" : "2.40", "ET" : ""},
            "mid" : {"CT" : "2.30", "ET" : ""},
            "high" : {"CT" : "2.30", "ET" : ""},
            "poly" : {"CT" : "2.30", "ET" : ""}            
        },
        "-2.25" : {
            "low" : {"CT" : "2.40", "ET" : ""},
            "mid" : {"CT" : "2.30", "ET" : ""},
            "high" : {"CT" : "2.30", "ET" : ""},
            "poly" : {"CT" : "2.30", "ET" : ""}            
        },
        "-2.50" : {
            "low" : {"CT" : "2.40", "ET" : ""},
            "mid" : {"CT" : "2.30", "ET" : ""},
            "high" : {"CT" : "2.30", "ET" : ""},
            "poly" : {"CT" : "2.30", "ET" : ""}            
        },
        "-2.75" : {
            "low" : {"CT" : "2.40", "ET" : ""},
            "mid" : {"CT" : "2.30", "ET" : ""},
            "high" : {"CT" : "2.30", "ET" : ""},
            "poly" : {"CT" : "2.30", "ET" : ""}            
        },
        "-3.00" : {
            "low" : {"CT" : "2.40", "ET" : ""},
            "mid" : {"CT" : "2.30", "ET" : ""},
            "high" : {"CT" : "2.30", "ET" : ""},
            "poly" : {"CT" : "2.30", "ET" : ""}            
        },
        "-3.25" : {
            "low" : {"CT" : "2.40", "ET" : ""},
            "mid" : {"CT" : "2.30", "ET" : ""},
            "high" : {"CT" : "2.30", "ET" : ""},
            "poly" : {"CT" : "2.30", "ET" : ""}            
        },
        "-3.50" : {
            "low" : {"CT" : "2.40", "ET" : ""},
            "mid" : {"CT" : "2.30", "ET" : ""},
            "high" : {"CT" : "2.30", "ET" : ""},
            "poly" : {"CT" : "2.30", "ET" : ""}            
        },
        "-3.50" : {
            "low" : {"CT" : "2.40", "ET" : ""},
            "mid" : {"CT" : "2.30", "ET" : ""},
            "high" : {"CT" : "2.30", "ET" : ""},
            "poly" : {"CT" : "2.30", "ET" : ""}            
        },
        "-3.75" : {
            "low" : {"CT" : "2.40", "ET" : ""},
            "mid" : {"CT" : "2.30", "ET" : ""},
            "high" : {"CT" : "2.30", "ET" : ""},
            "poly" : {"CT" : "2.30", "ET" : ""}            
        },
        "-4.00" : {
            "low" : {"CT" : "2.30", "ET" : ""},
            "mid" : {"CT" : "2.20", "ET" : ""},
            "high" : {"CT" : "2.20", "ET" : ""},
            "poly" : {"CT" : "2.20", "ET" : ""}            
        },
        "-4.25" : {
            "low" : {"CT" : "2.20", "ET" : ""},
            "mid" : {"CT" : "2.10", "ET" : ""},
            "high" : {"CT" : "2.10", "ET" : ""},
            "poly" : {"CT" : "2.10", "ET" : ""}            
        },
        "-4.50" : {
            "low" : {"CT" : "2.10", "ET" : ""},
            "mid" : {"CT" : "2.00", "ET" : ""},
            "high" : {"CT" : "2.00", "ET" : ""},
            "poly" : {"CT" : "2.00", "ET" : ""}            
        },
        "-4.75" : {
            "low" : {"CT" : "2.10", "ET" : ""},
            "mid" : {"CT" : "2.00", "ET" : ""},
            "high" : {"CT" : "2.00", "ET" : ""},
            "poly" : {"CT" : "2.00", "ET" : ""}            
        },
        "-5.00" : {
            "low" : {"CT" : "2.10", "ET" : ""},
            "mid" : {"CT" : "2.00", "ET" : ""},
            "high" : {"CT" : "2.00", "ET" : ""},
            "poly" : {"CT" : "2.00", "ET" : ""}            
        }
    }
}

'''

tag_swap = '''
{
    "tag_swap" : {
        {
            "tag" : {
                "sign" : "",
                "old_value" : "",
                "new" : ""
                "new_value" : ""            
            }
        }
    }
}

'''

blanks_template = '''
{
    "blank_list" : {
        "0000" : {
            "blank_code" : "0000",
            "code" : "000",
            "index" : "1.53",
            "index_group" : "153",
            "index_type" : "low",
            "base_list": {
                "0" : "0.00",
                "1" : "1.00",
                "2" : "2.00",
                "3" : "3.00",
                "4" : "4.00",
                "5" : "5.00",
                "6" : "6.00",
                "7" : "7.00",
                "8" : "8.00",
                "9" : "9.00",
                "10" : "10.00"
            }
        },
        "4155" : {
            "blank_code" : "4155",
            "code" : "083",
            "index" : "1.49",
            "index_type" : "low",
            "index_group" : "149",
            "base_list": {
                "0" : "0.50",
                "2" : "2.00",
                "4" : "4.00",
                "5" : "5.00",
                "6" : "6.00",
                "8" : "8.00",
                "10" : "10.00"
            }
        }
    }
}

'''

desings_list_template = '''
{
    "design_list" : {
        "desing" : {
            "lds" : "SCH",
            "lds_code" : "1",
            "design" : "Natural Accuracy",
            "design_code" : "01",
            "design_type" : "PR",
            "corr_len_translator" : "2",
            "corr_len" : [
                "14", 
                "16", 
                "18"
            ]
        }
    }
}
'''


'''
=============================================================================================

        Functions       Functions       Functions       Functions       Functions            

=============================================================================================
''' 

def quit_func():
    '''
    check event and terminated thread on set
    '''
    logger.info('Quit pressed')
    event.set()
    return


def shape_resize(job_data: dict) -> dict:
    '''
    Return the shape resized to main function
    '''
    try:
        side = job_data['DO']
        hbox = calc_proccess.return_side_value(side, job_data['HBOX'])
        vbox = calc_proccess.return_side_value(side, job_data['VBOX'])
        logger.debug(f'shape_resize {side} {hbox} {vbox}')
        shape_resized = frame_resize.resize(job_data['TRCFMT'], hbox, vbox)
        logger.info(f'Returning shape resized')
        return shape_resized
    except Exception as error: 
        logger.error(f'shape_resize error {error}')
        raise error





def shape_to_optical_center(parameters: Parameters, shape_resized: dict, job_data: dict) -> dict:
    '''
    Return the shape recentered to the optical center for thickness calculation
    '''
    try:
        ipd = calc_proccess.fill_default(parameters.default_ipd, job_data.get('IPD', {'R': '', 'L': ''}))
        ocht = calc_proccess.fill_default(parameters.default_ocht, job_data.get('OCHT', {'R': '', 'L': ''}))
        dbl = calc_proccess.fill_default(parameters.default_dbl, job_data.get('DBL', ''))

        '''
        Get design
        If PR substract center to far value from OCHT. < usually 4 mm
        '''

        logger.debug(f'shape_to_opctical_center {ipd} {ocht} {dbl}')
        shape_recentered = frame_resize.shape_center(shape_resized, ipd, ocht, dbl)
        logger.info(f'Returning shape recentered')
        return shape_recentered
    except Exception as error:
        logger.error(f'shpe_optical_center error {error}')
        raise error


def main(event: threading.Event, config: Configuration, *args) -> None:
    if event.is_set():
        return
    
    done_list = []
    while True:
        sleep(config.sleep_time)
        file_list = file_handler.file_list(config.input, config.extension)
        if len(file_list) > 0:
            for file in file_list:
                if file not in done_list:
                    updated_tags = {}
                    try:
                        file_contents = file_handler.file_reader(join(config.input, file))
                        job_data = vca_handler.VCA_to_dict(file_contents)

                        logger.info(f'Starting calculation for {job_data["JOB"]}')
                        # if len(lnam_swap_list) > 0: # LNAM Swapper
                        #     new_lnam = calc_proccess.lnam_swapper(lnam_swap_list, job_data['LNAM']['L'] if job_data['DO'] == 'L' else job_data['LNAM']['R'])
                        #     if new_lnam:
                        #         updated_tags['LNAM'] = calc_proccess.set_side_value(job_data['DO'], new_lnam)
                        #         logger.debug(f'LNAM: {new_lnam}')
                        shape_resized = shape_resize(job_data)
                        shape_optical_center = shape_to_optical_center(parameters, shape_resized, job_data)
                        

                    except Exception as error:
                        logger.error(f'VCA conversion error {error}')
                        file_handler.file_move_copy(config.input, config.error, file, False, True)
        pass






'''
=============================================================================================

        Main        Main        Main        Main        Main        Main        Main        

=============================================================================================
''' 


if __name__ == '__main__':
    logger = logging.getLogger()
    log_builder.logger_setup(logger)


    try:
        config = Configuration.init_dict(json_config.load_json_config('config.json', config))
        parameters = Parameters.init_dict(json_config.load_json_config('parameters.json', parameters_template))
        min_thickness = FrameThicknessList.init_dict(json_config.load_json_config('min_thickness.json', min_thickness_template))
        blank_list = BlankList.init_dict(json_config.load_json_config('blank_list.json', blanks_template))
        design_list = DesignList.init_dict(json_config.load_json_config('design_list.json', desings_list_template))
    except:
        logger.critical('Could not load config file')
        exit()


    keyboard.add_hotkey('space', quit_func)
    event = threading.Event()

    for _ in range(3):
        if event.is_set():
            break
        thread = threading.Thread(target=main, args=(event, config, parameters, min_thickness, blank_list, design_list,), name='white_label')
        thread.start()
        thread.join()

    logger.debug('Done')